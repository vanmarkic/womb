---
import { getCollection } from 'astro:content';
import BaseLayout from '../../../layouts/BaseLayout.astro';
import Header from '../../../components/Header.astro';
import RecordingsPlaylist from '../../../components/RecordingsPlaylist';
import { translations, type Language } from '../../../i18n';

export async function getStaticPaths() {
	let recordings = [];
	try {
		recordings = await getCollection('recordings');
	} catch (error) {
		// Collection doesn't exist or is empty
	}
	const languages: Language[] = ['en', 'fr'];

	return languages.map(lang => ({
		params: { lang },
		props: {
			recordings: recordings.sort((a, b) => b.data.date.getTime() - a.data.date.getTime()),
			lang
		}
	}));
}

const { recordings, lang } = Astro.props;
const t = translations[lang];
---

<BaseLayout lang={lang} title={t.recordings.archive}>
	<Header lang={lang} />

	<main class="recordings-archive">
		<h1>{t.recordings.archive}</h1>

		{recordings.length === 0 ? (
			<div class="no-recordings">
				<p>{lang === 'en' ? 'No recordings available yet' : 'Aucun enregistrement disponible'}</p>
			</div>
		) : (
		<RecordingsPlaylist
			recordings={recordings}
			lang={lang}
			client:load
		/>
		)}
	</main>
</BaseLayout>

<style>
	.recordings-archive {
		max-width: 1200px;
		margin: 0 auto;
		padding: 3rem 2rem;
	}

	h1 {
		font-size: 2.5rem;
		font-weight: 200;
		letter-spacing: 0.2em;
		margin-bottom: 3rem;
		text-transform: lowercase;
	}


	.no-recordings {
		text-align: center;
		padding: 4rem 2rem;
		color: rgba(255, 255, 255, 0.5);
		font-size: 1.1rem;
		letter-spacing: 0.05em;
	}

	@media (max-width: 768px) {
		.recordings-archive {
			padding: 2rem 1rem;
		}

		h1 {
			font-size: 2rem;
		}
	}
</style>